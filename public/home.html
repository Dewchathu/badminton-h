<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Firebase Data Display</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="home.css" />

    <!-- Add dark mode styles -->
    <style>
      body {
        background-color: #2c3e50;
        color: #ecf0f1;
        font-family: "Arial", sans-serif;
        background: url(./assets/muktasim-azlan-rjWfNR_AC5g-unsplash.jpg);
        background-size: cover;
        background-repeat: no-repeat;
      }

      h1 {
        color: #3498db;
      }

      .timestamp {
        color: #ecf0f1;
        padding: 20px;
        margin-bottom: 10px;
        border: #ecf0f1 solid 1px;
        border-radius: 10px;
        max-width: 300px;
        margin-left: auto;
        margin-right: auto;
      }

      .add {
        padding: 10px;
        width: 100px;
        color: #fff;
        border: none;
        outline: none;
        background: #8c52ff;
        cursor: pointer;
        font-size: 12px;
        margin-top: 10px;
        margin-left: 55px;
      }
    </style>
  </head>
  <body>
    <div class="row">
      <div class="col-3">
        <div class="box1 left">
          <form action="" id="myform">
            <div class="form1">
              <h2>Details</h2>
              <form2>
                <div class="inputbox">
                  <input type="text" value="" id="Fname" required />
                  <span>First Name</span>
                </div>
                <div class="inputbox">
                  <input type="text" value="" id="Lname" required />
                  <span>Last Name</span>
                </div>
                <div class="inputbox">
                  <input type="number" value="" id="age" required />
                  <span>Age</span>
                </div>
  
                <div class="inputdropdown">
                  <!-- Replace text input with a dropdown for 'Sex' -->
                  <span>Sex</span>
                  <select id="sex" required>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                  </select>
                </div>
                <div class="inputdropdown">
                  <span>District</span>
                  <!-- Replace text input with a dropdown for 'District' -->
                  <select id="district" required>
                    <option value="colombo">Colombo</option>
                    <option value="gampaha">Gampaha</option>
                    <option value="kalutara">Kalutara</option>
                    <option value="kandy">Kandy</option>
                    <option value="matale">Matale</option>
                    <option value="nuwaraeliya">Nuwara Eliya</option>
                    <option value="galle">Galle</option>
                    <option value="matara">Matara</option>
                    <option value="hambantota">Hambantota</option>
                    <option value="jaffna">Jaffna</option>
                    <option value="kilinochchi">Kilinochchi</option>
                    <option value="mannar">Mannar</option>
                    <option value="mullaitivu">Mullaitivu</option>
                    <option value="vavuniya">Vavuniya</option>
                    <option value="puttalam">Puttalam</option>
                    <option value="kurunegala">Kurunegala</option>
                    <option value="anuradhapura">Anuradhapura</option>
                    <option value="polonnaruwa">Polonnaruwa</option>
                    <option value="badulla">Badulla</option>
                    <option value="monaragala">Monaragala</option>
                    <option value="ratnapura">Ratnapura</option>
                    <option value="kegalle">Kegalle</option>
                  </select>
                </div>
  
                <div class="btn">
                  <input type="submit" value="Start" class="sub" id="StartBtn" />
                  <input type="submit" value="Stop" class="sub" id="StopBtn" />
                  <input type="submit" value="Reset" class="sub" id="ResetBtn" />
                </div>
                <div class="addbtn">
                  <input type="submit" value="Add" class="add" id="AddBtn" />
                </div>
              </form2>
            </div>
          </form>
          
        </div>
      </div>
      <div class="col-1"></div>
      <div class="col-8">
        <img src="assets/playground.jpg" class="img-fluid image" alt="..." />

        <div class="row">
          <div class="col">
            <div class="row">
              <div id="time-difference-1-7" class="timestamp"></div>
            </div>
            <div class="row"></div>
            <div class="row">
              <div id="time-difference-7-2" class="timestamp"></div>
            </div>
          </div>
          <div class="col">
            <div class="row">
              <div id="time-difference-7-3" class="timestamp"></div>
            </div>
            <div class="row">
              <div id="timestamp-display-7" class="timestamp"></div>
            </div>
            <div class="row">
              <div id="time-difference-7-4" class="timestamp"></div>
            </div>
          </div>
          <div class="col">
            <div class="row">
              <div id="time-difference-7-5" class="timestamp"></div>
            </div>
            <div class="row"></div>
            <div class="row">
              <div id="time-difference-7-6" class="timestamp"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      // Import the functions you need from the SDKs
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
      import {
        getDatabase,
        ref,
        onValue,
        set,
        push,
      } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyD0wYYVfaBvSaktiXMQ0tCc2vWdxmAS2k8",
        authDomain: "badminton-h.firebaseapp.com",
        databaseURL:
          "https://badminton-h-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "badminton-h",
        storageBucket: "badminton-h.appspot.com",
        messagingSenderId: "370589389980",
        appId: "1:370589389980:web:de228c53e880e2f2510959",
        measurementId: "G-KKR7HHJ099",
      };

      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);
      const timestampRef = ref(database, "ir_test/");

      let timestamp1,
        timestamp2,
        timestamp3,
        timestamp4,
        timestamp5,
        timestamp6,
        timestamp7;

      let fname = document.getElementById("Fname");
      let lname = document.getElementById("Lname");
      let age = document.getElementById("age");
      let email = document.getElementById("sex");
      let phone = document.getElementById("district");

      let add = document.getElementById("AddBtn");
      let reset = document.getElementById("ResetBtn");

      function AddData() {
        if (
          fname.value.trim() === "" ||
          lname.value.trim() === "" ||
          age.value.trim() === ""
        ) {
          alert("Please fill in all required fields.");
          return;
        }

        const PlayerListRef = ref(database, "players");
        const newPlayerRef = push(PlayerListRef);

        set(newPlayerRef, {
          NameOfPlayer: { firstname: Fname.value, lastname: Lname.value },
          age: age.value,
          sex: sex.value,
          district: district.value,
        });

        resetFormField();
      }

      function resetFormField() {
        document.getElementById("Form1").reset();
      }

      AddBtn.addEventListener("click", AddData);
      ResetBtn.addEventListener("click", resetFormField);

      // Listen for changes in the timestamp value
      onValue(timestampRef, (snapshot) => {
        timestamp1 = snapshot.val().unit1;
        timestamp2 = snapshot.val().unit2;
        timestamp3 = snapshot.val().unit3;
        timestamp4 = snapshot.val().unit4;
        timestamp5 = snapshot.val().unit5;
        timestamp6 = snapshot.val().unit6;
        timestamp7 = snapshot.val().unit7;

        if (timestamp1 && timestamp7) {
          // Convert timestamps to milliseconds and ensure they are valid dates
          const timestampNew1 = new Date(parseInt(timestamp1, 10));
          const timestampNew7 = new Date(parseInt(timestamp2, 10));

          if (!isNaN(timestamp1) && !isNaN(timestamp7)) {
            // Calculate the time difference in seconds
            const timeDifferenceInSeconds =
              (timestampNew7 - timestampNew1) / 1000;

            // Display the time difference as a number in seconds
            document.getElementById("time-difference-1-7").innerHTML =
              "Time Difference: " + timeDifferenceInSeconds + " seconds";
          } else {
            document.getElementById("time-difference-1-7").innerHTML =
              "Invalid timestamps";
          }
        } else {
          document.getElementById("time-difference-1-7").innerHTML =
            "Missing timestamps";
        }

        //  ......................

        if (timestamp2 && timestamp7) {
          // Convert timestamps to milliseconds and ensure they are valid dates
          const timestampNew2 = new Date(parseInt(timestamp2, 10));
          const timestampNew7 = new Date(parseInt(timestamp7, 10));

          if (!isNaN(timestamp2) && !isNaN(timestamp7)) {
            // Calculate the time difference in seconds
            const timeDifferenceInSeconds =
              (timestampNew7 - timestampNew2) / 1000;

            // Display the time difference as a number in seconds
            document.getElementById("time-difference-7-2").innerHTML =
              "Time Difference: " + timeDifferenceInSeconds + " seconds";
          } else {
            document.getElementById("time-difference-7-2").innerHTML =
              "Invalid timestamps";
          }
        } else {
          document.getElementById("time-difference-7-2").innerHTML =
            "Missing timestamps";
        }

        // ....................

        if (timestamp3 && timestamp7) {
          // Convert timestamps to milliseconds and ensure they are valid dates
          const timestampNew3 = new Date(parseInt(timestamp3, 10));
          const timestampNew7 = new Date(parseInt(timestamp7, 10));

          if (!isNaN(timestamp3) && !isNaN(timestamp7)) {
            // Calculate the time difference in seconds
            const timeDifferenceInSeconds =
              (timestampNew7 - timestampNew3) / 1000;

            // Display the time difference as a number in seconds
            document.getElementById("time-difference-7-3").innerHTML =
              "Time Difference: " + timeDifferenceInSeconds + " seconds";
          } else {
            document.getElementById("time-difference-7-3").innerHTML =
              "Invalid timestamps";
          }
        } else {
          document.getElementById("time-difference-7-3").innerHTML =
            "Missing timestamps";
        }

        // ..........................

        if (timestamp4 && timestamp7) {
          // Convert timestamps to milliseconds and ensure they are valid dates
          const timestampNew4 = new Date(parseInt(timestamp4, 10));
          const timestampNew7 = new Date(parseInt(timestamp7, 10));

          if (!isNaN(timestamp4) && !isNaN(timestamp7)) {
            // Calculate the time difference in seconds
            const timeDifferenceInSeconds =
              (timestampNew7 - timestampNew4) / 1000;

            // Display the time difference as a number in seconds
            document.getElementById("time-difference-7-4").innerHTML =
              "Time Difference: " + timeDifferenceInSeconds + " seconds";
          } else {
            document.getElementById("time-difference-7-4").innerHTML =
              "Invalid timestamps";
          }
        } else {
          document.getElementById("time-difference-7-4").innerHTML =
            "Missing timestamps";
        }

        //  ......................

        if (timestamp5 && timestamp7) {
          // Convert timestamps to milliseconds and ensure they are valid dates
          const timestampNew5 = new Date(parseInt(timestamp5, 10));
          const timestampNew7 = new Date(parseInt(timestamp7, 10));

          if (!isNaN(timestamp5) && !isNaN(timestamp7)) {
            // Calculate the time difference in seconds
            const timeDifferenceInSeconds =
              (timestampNew7 - timestampNew5) / 1000;

            // Display the time difference as a number in seconds
            document.getElementById("time-difference-7-5").innerHTML =
              "Time Difference: " + timeDifferenceInSeconds + " seconds";
          } else {
            document.getElementById("time-difference-7-5").innerHTML =
              "Invalid timestamps";
          }
        } else {
          document.getElementById("time-difference-7-5").innerHTML =
            "Missing timestamps";
        }

        //  ......................

        if (timestamp6 && timestamp7) {
          // Convert timestamps to milliseconds and ensure they are valid dates
          const timestampNew6 = new Date(parseInt(timestamp6, 10));
          const timestampNew7 = new Date(parseInt(timestamp7, 10));

          if (!isNaN(timestamp6) && !isNaN(timestamp7)) {
            // Calculate the time difference in seconds
            const timeDifferenceInSeconds =
              (timestampNew7 - timestampNew6) / 1000;

            // Display the time difference as a number in seconds
            document.getElementById("time-difference-7-6").innerHTML =
              "Time Difference: " + timeDifferenceInSeconds + " seconds";
          } else {
            document.getElementById("time-difference-7-6").innerHTML =
              "Invalid timestamps";
          }
        } else {
          document.getElementById("time-difference-7-6").innerHTML =
            "Missing timestamps";
        }
      });
    </script>
  </body>
</html>
